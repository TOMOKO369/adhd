<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>発達特性セルフチェック</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Kiwi+Maru:wght@300;400;500&family=Murecho:wght@300;400;700&family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#88c0d0",
                        "accent-pink": "#f3a6b1",
                        "accent-yellow": "#f9e1a1",
                        "background-light": "#fdfbf7",
                        "text-main": "#4a4e69",
                    },
                    fontFamily: {
                        "handwriting": ["'Kiwi Maru'", "serif"],
                        "sans": ["'Murecho'", "sans-serif"]
                    },
                },
            },
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
      .watercolor-blob { filter: blur(60px); opacity: 0.5; z-index: -1; }
      .storybook-border { border-radius: 60px 30px 70px 40px / 40px 60px 30px 70px; }
      .paper-texture { background-image: url('https://www.transparenttextures.com/patterns/handmade-paper.png'); }
      .speech-bubble-left { position: relative; background: white; border-radius: 2rem; }
      .speech-bubble-left::after { content: ''; position: absolute; left: -15px; top: 30px; width: 0; height: 0; border: 15px solid transparent; border-right-color: white; border-left: 0; }
      .handwritten-font { font-family: 'Kiwi Maru', serif; }
      .card { display: none; animation: fadeIn 0.5s ease; }
      .card.active { display: block; }
      @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
      .flow-arrow { position: relative; }
      .flow-arrow::after { content: '↓'; display: block; text-align: center; color: #88c0d0; font-weight: bold; margin: 4px 0; }
      .flow-arrow:last-child::after { display: none; }
      .high { color: #e11d48 !important; }
    }
</style>
</head>

<body
    class="bg-background-light font-sans text-text-main selection:bg-accent-pink/30 paper-texture min-h-screen relative overflow-x-hidden">
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
        <div class="absolute -top-24 -left-24 w-[500px] h-[500px] bg-accent-pink/20 rounded-full watercolor-blob"></div>
        <div class="absolute top-1/4 -right-24 w-96 h-96 bg-primary/20 rounded-full watercolor-blob"></div>
        <div class="absolute bottom-10 left-1/4 w-[600px] h-[600px] bg-accent-yellow/30 rounded-full watercolor-blob">
        </div>
    </div>

    <div class="relative w-full max-w-[800px] mx-auto z-10 px-4 py-8 md:py-12">

        <!-- ================= スタート画面 ================= -->
        <div id="start-screen" class="card active">
            <div
                class="bg-white/70 backdrop-blur-sm storybook-border shadow-xl border-8 border-white p-6 md:p-12 text-center mb-12 relative overflow-hidden">

                <div class="absolute top-4 right-8 opacity-20 rotate-12 pointer-events-none">
                    <span class="material-symbols-outlined text-6xl text-accent-pink">auto_stories</span>
                </div>

                <div class="text-slate-500 font-bold handwritten-font tracking-widest text-sm mb-4">────────────</div>
                <h1 class="text-3xl md:text-5xl font-bold handwritten-font text-slate-800 mb-6 leading-tight">
                    発達特性<br><span
                        class="text-accent-pink decoration-wavy underline underline-offset-8 mt-2 inline-block">セルフチェック</span>
                </h1>
                <div class="text-slate-500 font-bold handwritten-font tracking-widest text-sm mb-6">────────────</div>

                <p class="text-slate-600 text-lg md:text-xl leading-loose handwritten-font mb-8 font-bold">
                    診断がなくても利用できます<br>
                    特性の傾向と<br>
                    支援の進め方がわかります
                </p>

                <div
                    class="grid grid-cols-1 sm:grid-cols-2 gap-4 max-w-sm mx-auto mb-10 text-center bg-white/50 p-6 rounded-3xl border-2 border-primary/20">
                    <div class="handwritten-font font-bold text-slate-700">傾向がわかる</div>
                    <div class="handwritten-font font-bold text-slate-700">支援がわかる</div>
                    <div class="handwritten-font font-bold text-slate-700">手続きがわかる</div>
                    <div class="handwritten-font font-bold text-slate-700">相談先がわかる</div>
                </div>

                <div class="mb-4">
                    <span
                        class="bg-primary/10 text-primary font-bold handwritten-font text-lg px-6 py-2 rounded-full border border-primary/20">（小）約3分
                        / 無料</span>
                </div>

                <button onclick="startCheck()"
                    class="w-full max-w-[300px] h-16 bg-accent-pink text-white rounded-full handwritten-font font-bold text-2xl shadow-xl shadow-accent-pink/30 hover:-translate-y-1 transition-all mx-auto focus:outline-none mb-6 mt-4 flex items-center justify-center gap-2">
                    <span class="material-symbols-outlined text-3xl">play_circle</span>スタート
                </button>

                <div
                    class="bg-accent-yellow/30 border-2 border-dashed border-accent-yellow/60 rounded-2xl p-4 max-w-md mx-auto">
                    <strong class="block text-amber-700 text-sm handwritten-font font-bold mb-1">【免責事項】</strong>
                    <p class="text-slate-600 handwritten-font text-xs leading-relaxed">
                        本サイトは医学的診断ではありません。利用は自己責任でお願いします。運営者は一切の責任を負いません。
                    </p>
                </div>
            </div>

            <!-- 困り感フローチャート -->
            <div
                class="bg-white/80 backdrop-blur-sm rounded-[2rem] border-4 border-white shadow-lg p-6 md:p-10 relative overflow-hidden">
                <!-- 装飾 -->
                <div class="absolute top-4 left-4 opacity-10 rotate-[-15deg] pointer-events-none">
                    <span class="material-symbols-outlined text-6xl text-primary">route</span>
                </div>

                <h2
                    class="text-2xl font-bold handwritten-font text-center text-slate-800 mb-8 flex items-center justify-center gap-2">
                    支援の進め方マップ
                </h2>

                <!-- 困り感ルート -->
                <div class="mb-10 p-6 bg-primary/5 rounded-3xl border-2 border-primary/20 relative">
                    <div
                        class="absolute -top-4 left-1/2 -translate-x-1/2 bg-white px-6 py-2 rounded-full shadow-sm border border-slate-100 font-bold handwritten-font text-slate-700 text-lg">
                        もしかしたらと感じたら・・・</div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-6">
                        <!-- 軽い困り感 -->
                        <div
                            class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100 flex flex-col items-center text-center flow-arrow border-t-4 border-t-accent-yellow/50">
                            <span class="text-sm font-bold text-slate-600 mb-3">軽い困り感</span>
                            <span class="text-amber-700/80 font-bold text-sm mb-3">学校へ相談</span>
                            <div
                                class="bg-accent-yellow/30 text-amber-800 font-bold px-4 py-2 rounded-xl text-sm w-full">
                                通級指導教室</div>
                        </div>
                        <!-- 日常生活 -->
                        <div
                            class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100 flex flex-col items-center text-center flow-arrow border-t-4 border-t-accent-pink/50">
                            <span class="text-sm font-bold text-slate-600 mb-3">日常生活で困難が多い</span>
                            <span class="text-pink-700/80 font-bold text-sm mb-3">市役所へ相談</span>
                            <div class="bg-accent-pink/20 text-pink-800 font-bold px-4 py-2 rounded-xl text-sm w-full">
                                療育<br><span class="text-[10px] opacity-80">(放課後等デイ)</span></div>
                        </div>
                        <!-- 通常授業 -->
                        <div
                            class="bg-white p-5 rounded-2xl shadow-sm border border-slate-100 flex flex-col items-center text-center flow-arrow border-t-4 border-t-primary/50">
                            <span class="text-sm font-bold text-slate-600 mb-3">通常授業の継続が難しい</span>
                            <span class="text-teal-700/80 font-bold text-sm mb-3">学校へ相談</span>
                            <div class="bg-primary/20 text-teal-800 font-bold px-4 py-2 rounded-xl text-sm w-full">
                                支援学級<br><span class="text-[10px] opacity-80">(ひまわり学級)</span></div>
                        </div>
                    </div>
                </div>

                <!-- 具体的な手続きフロー -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- 療育のながれ -->
                    <div
                        class="bg-accent-pink/5 rounded-2xl p-5 border border-accent-pink/20 hover:shadow-md transition-shadow">
                        <h4
                            class="font-bold handwritten-font text-center text-pink-700 mb-4 border-b-2 border-accent-pink/30 pb-2">
                            療育の流れ</h4>
                        <ol
                            class="text-sm space-y-3 font-bold text-slate-600 handwritten-font relative pl-1 text-center">
                            <li class="flow-arrow">① 市役所へ相談</li>
                            <li class="flow-arrow">② 発達相談</li>
                            <li class="flow-arrow">③ 受給者証申請</li>
                            <li class="flow-arrow">④ 支給決定</li>
                            <li class="flow-arrow">⑤ 事業所見学</li>
                            <li class="flow-arrow">⑥ 利用開始</li>
                        </ol>
                    </div>
                    <!-- 通級のながれ -->
                    <div
                        class="bg-accent-yellow/10 rounded-2xl p-5 border border-accent-yellow/30 hover:shadow-md transition-shadow">
                        <h4
                            class="font-bold handwritten-font text-center text-amber-700 mb-4 border-b-2 border-accent-yellow/40 pb-2">
                            通級の流れ</h4>
                        <ol
                            class="text-sm space-y-3 font-bold text-slate-600 handwritten-font relative pl-1 text-center">
                            <li class="flow-arrow">① 担任に相談</li>
                            <li class="flow-arrow">② 校内検討</li>
                            <li class="flow-arrow">③ 教育委員会申請</li>
                            <li class="flow-arrow">④ 面談</li>
                            <li class="flow-arrow">⑤ 通級開始</li>
                        </ol>
                    </div>
                    <!-- 支援学級のながれ -->
                    <div
                        class="bg-primary/10 rounded-2xl p-5 border border-primary/20 hover:shadow-md transition-shadow">
                        <h4
                            class="font-bold handwritten-font text-center text-teal-700 mb-4 border-b-2 border-primary/30 pb-2">
                            支援級の流れ</h4>
                        <ol
                            class="text-sm space-y-3 font-bold text-slate-600 handwritten-font relative pl-1 text-center">
                            <li class="flow-arrow">① 担任に相談</li>
                            <li class="flow-arrow">② 校内会議</li>
                            <li class="flow-arrow">③ 教育委員会申請</li>
                            <li class="flow-arrow">④ 見学・体験</li>
                            <li class="flow-arrow">⑤ 判定</li>
                            <li class="flow-arrow">⑥ 支援学級開始</li>
                        </ol>
                    </div>
                </div>

            </div>
        </div>

        <!-- ================= 質問画面 ================= -->
        <div id="question-screen" class="card">
            <div
                class="bg-white/80 backdrop-blur-md storybook-border shadow-2xl border-8 border-white p-6 md:p-12 relative overflow-hidden">
                <div class="flex justify-between items-center mb-8">
                    <div class="inline-block bg-accent-yellow/40 text-amber-800 px-6 py-2 rounded-full font-bold handwritten-font tracking-widest border-2 border-white shadow-sm"
                        id="category-badge">
                        情緒型発達
                    </div>
                    <div class="text-primary font-bold handwritten-font text-lg">
                        <span id="current-count" class="text-2xl">1</span> / <span id="total-count"
                            class="text-lg text-primary/70">100</span>
                    </div>
                </div>

                <div class="w-full h-4 bg-primary/10 rounded-full overflow-hidden mb-12 shadow-inner">
                    <div class="h-full bg-accent-pink transition-all duration-300 ease-out w-0 rounded-full"
                        id="progress-fill"></div>
                </div>

                <div
                    class="bg-white border-2 border-primary/20 rounded-3xl p-8 mb-10 shadow-sm relative min-h-[12rem] flex items-center justify-center speech-bubble-left">
                    <p class="text-xl md:text-3xl font-bold handwritten-font text-slate-800 leading-relaxed md:leading-loose text-center"
                        id="question-text">
                        <!-- 質問文 -->
                    </p>
                </div>

                <div class="flex flex-col md:flex-row gap-4 justify-center items-center mb-6">
                    <button onclick="answer(true)"
                        class="w-full md:w-1/2 h-20 bg-accent-pink text-white rounded-[2rem] handwritten-font font-bold text-2xl shadow-xl shadow-accent-pink/20 border-4 border-white hover:-translate-y-1 hover:bg-pink-400 transition-all flex items-center justify-center gap-3">
                        <span class="material-symbols-outlined text-3xl">mood</span> はい
                    </button>
                    <button onclick="answer(false)"
                        class="w-full md:w-1/2 h-20 bg-primary/80 text-white rounded-[2rem] handwritten-font font-bold text-2xl shadow-xl shadow-primary/20 border-4 border-white hover:-translate-y-1 hover:bg-primary transition-all flex items-center justify-center gap-3">
                        <span class="material-symbols-outlined text-3xl">sentiment_neutral</span> いいえ
                    </button>
                </div>

                <div class="text-center mt-6">
                    <button onclick="goBack()" id="back-btn" style="display: none;"
                        class="text-slate-400 hover:text-primary underline handwritten-font text-sm transition-colors bg-transparent border-0">
                        前の問題に戻る
                    </button>
                </div>
            </div>
        </div>

        <!-- ================= 結果画面 ================= -->
        <div id="result-screen" class="card">
            <div
                class="bg-white/80 backdrop-blur-md storybook-border shadow-2xl border-8 border-white p-6 md:p-12 text-center relative overflow-hidden">
                <div class="mb-10 text-center">
                    <h2 class="text-3xl md:text-4xl font-bold handwritten-font text-slate-800 mb-2">チェックが終わりました</h2>
                    <div class="w-24 h-1 bg-accent-yellow mx-auto rounded-full mb-4"></div>
                    <p class="text-slate-600 handwritten-font">該当する項目の割合（％）</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
                    <div
                        class="bg-white border-4 border-primary/20 rounded-[3rem] p-8 shadow-md relative group hover:border-primary/50 transition-colors">
                        <div
                            class="absolute -top-6 left-1/2 -translate-x-1/2 w-12 h-12 bg-primary rounded-full flex items-center justify-center border-4 border-white shadow-sm">
                            <span class="material-symbols-outlined text-white">favorite</span>
                        </div>
                        <div class="text-primary font-bold handwritten-font tracking-widest mb-4 mt-2">情緒型発達</div>
                        <div class="text-5xl md:text-6xl font-bold text-slate-700 handwritten-font" id="res-emotion">
                            0<span class="text-2xl text-slate-400 ml-1">%</span></div>
                    </div>

                    <div
                        class="bg-white border-4 border-accent-yellow/40 rounded-[3rem] p-8 shadow-md relative group hover:border-accent-yellow transition-colors">
                        <div
                            class="absolute -top-6 left-1/2 -translate-x-1/2 w-12 h-12 bg-accent-yellow rounded-full flex items-center justify-center border-4 border-white shadow-sm text-amber-700">
                            <span class="material-symbols-outlined">psychology</span>
                        </div>
                        <div class="text-amber-700 font-bold handwritten-font tracking-widest mb-4 mt-2">知育型発達</div>
                        <div class="text-5xl md:text-6xl font-bold text-slate-700 handwritten-font" id="res-intellect">
                            0<span class="text-2xl text-slate-400 ml-1">%</span></div>
                    </div>
                </div>

                <div id="guidance-section" style="display: none;"
                    class="bg-accent-pink/10 border-4 border-dashed border-accent-pink/50 rounded-[2rem] p-8 mb-10 text-left relative">
                    <div
                        class="absolute -top-5 -left-5 w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-md rotate-[-10deg]">
                        <span class="material-symbols-outlined text-accent-pink">notifications_active</span>
                    </div>
                    <h3 class="text-xl font-bold handwritten-font text-slate-800 mb-4 flex items-center gap-2">
                        <span class="material-symbols-outlined text-accent-pink">info</span>
                        専門機関へのご案内
                    </h3>
                    <p class="text-slate-600 leading-relaxed handwritten-font mb-6">
                        該当率が80%を超えました。より詳しい状況の確認やサポートのために、以下の専門機関・窓口へご相談されることをお勧めいたします。
                    </p>
                    <div class="flex flex-col gap-4">
                        <a href="https://www.mhlw.go.jp/stf/seisakunitsuite/bunya/hukushi_kaigo/shougaishahukushi/hattatsu/index.html"
                            target="_blank" rel="noopener noreferrer"
                            class="flex justify-between items-center bg-white p-4 rounded-xl border-2 border-primary/20 text-slate-700 font-bold handwritten-font hover:border-accent-pink hover:text-accent-pink transition-all hover:shadow-md group">
                            発達障害者支援センター一覧
                            <span
                                class="material-symbols-outlined text-slate-400 group-hover:text-accent-pink group-hover:translate-x-1 transition-all">arrow_forward_ios</span>
                        </a>
                        <a href="https://h-navi.jp/" target="_blank" rel="noopener noreferrer"
                            class="flex justify-between items-center bg-white p-4 rounded-xl border-2 border-primary/20 text-slate-700 font-bold handwritten-font hover:border-accent-pink hover:text-accent-pink transition-all hover:shadow-md group">
                            LITALICO発達ナビ（病院検索）
                            <span
                                class="material-symbols-outlined text-slate-400 group-hover:text-accent-pink group-hover:translate-x-1 transition-all">arrow_forward_ios</span>
                        </a>
                    </div>
                </div>

                <div class="flex flex-col gap-4 items-center justify-center">
                    <button onclick="location.reload()"
                        class="bg-white border-2 border-primary/30 text-primary h-14 px-10 rounded-full handwritten-font font-bold text-lg hover:bg-primary/5 transition-all inline-flex items-center justify-center gap-2 shadow-sm focus:outline-none w-full max-w-sm">
                        <span class="material-symbols-outlined">refresh</span>
                        もう一度チェックする
                    </button>
                    <button onclick="showScreen('start-screen')"
                        class="bg-primary text-white h-14 px-10 rounded-full handwritten-font font-bold text-lg hover:bg-primary/90 transition-all inline-flex items-center justify-center gap-2 shadow-sm focus:outline-none w-full max-w-sm">
                        <span class="material-symbols-outlined">route</span>
                        支援の進め方を確認する
                    </button>
                </div>
            </div>
        </div>

    </div>

    <script>
        // -------------------------
        // 1. 質問データ定義
        // -------------------------
        const emotionData = [
            "相手の表情から感情を読み取るのが苦手",
            "冗談や皮肉を真に受けて傷つくことが多い",
            "会話で「行間を読む」ことが難しい",
            "興味があることなら、相手が退屈していても話し続けてしまう",
            "視線を合わせることに違和感や苦痛を感じる",
            "場の空気に合わない発言をしてしまうことがある",
            "比喩表現（「雲を掴むような」など）を言葉通りに受け取ってしまう",
            "初対面の人との雑談が極端に苦手",
            "名前を呼ばれても気づかないことがよくある",
            "集団行動よりも一人でいることを好む",
            "急な予定変更があると、激しく混乱したり怒ったりする",
            "自分なりの「独自のルール」や「手順」に強くこだわる",
            "物を置く位置や順番が少しでも変わると落ち着かない",
            "特定の分野（電車、数字、ロゴ等）に驚異的な記憶力がある",
            "毎日同じルートで移動することにこだわる",
            "感情の起伏が激しく、一度怒ると収まりにくい",
            "順番待ちや列に並ぶことが非常に苦痛",
            "考えるより先に体が動いてしまう（衝動性）",
            "じっとしていられず、手足をモゾモゾ動かしてしまう",
            "忘れ物や失くし物が日常的に多い",
            "掃除や片付けの段取りが立てられず、部屋が散らかる",
            "複数のことを同時に並行して行うのが苦手（マルチタスク困難）",
            "大きな音（掃除機、人混み、花火等）が苦手",
            "特定の服の肌触り（タグ、素材）を極端に嫌がる",
            "偏食が激しく、特定の食感のものしか食べられない",
            "眩しい光に対して、他の人より敏感に反応する",
            "自分の体をどこかにぶつけやすく、距離感が掴みづらい",
            "痛みに非常に強い、あるいは逆に非常に弱い",
            "人の話し声が背景の雑音に紛れて聞こえづらい",
            "自分の感情を言葉で説明するのが難しい",
            "手先が不器用で、紐結びやボタン留めが苦手",
            "表情が乏しい、あるいは「顔が怖い」と言われることがある",
            "独り言が多い、または人の言葉をオウム返しする",
            "予定がない日があると、何をすればいいか分からず不安になる",
            "集団の中で浮いていると感じることが多い",
            "勝ち負けに異常にこだわり、負けるとひどく落ち込む",
            "他人の持ち物を勝手に触ってしまうことがある",
            "正義感が強すぎて、他人の小さなミスを許せず指摘してしまう",
            "変化を嫌い、新しい環境に馴染むのに時間がかかる",
            "決まったフレーズを繰り返し使う癖がある",
            "自分が関心のない話には全く耳を貸さない",
            "お金の管理が苦手で、衝動買いをしてしまう",
            "締切間際にならないと作業に手がつかない",
            "相手との物理的な距離感が近すぎると言われる",
            "自分が他人からどう見られているか想像しにくい",
            "運動会や発表会などのイベントが苦痛だった",
            "名前を覚えるのが極端に苦手",
            "睡眠リズムが崩れやすく、朝起きるのが辛い",
            "指示を最後まで聞かずに動いて失敗する",
            "集中しすぎると周りの音が全く聞こえなくなる（過集中）"
        ];

        const intellectData = [
            "文章を読んでいるとき、同じ行を何度も読み返してしまう",
            "漢字の形が覚えられず、線が多かったり少なかったりする",
            "「ぬ」と「め」、「わ」と「ね」など似た文字を書き間違える",
            "文字の大きさがバラバラになり、マス目からはみ出す",
            "音読をすると、たどたどしくなる（拾い読み）",
            "鏡文字（左右反転した文字）を書いてしまう",
            "促音（「っ」）や拗音（「ゃ、ゅ、ょ」）の書き漏らしが多い",
            "文章を読んでも、その内容を要約することができない",
            "簡単な暗算に時間がかかる、または指を使わないとできない",
            "桁数の多い数字を書き写すときにミスをする",
            "繰り上がり、繰り下がりの計算で混乱する",
            "文章題の内容を式に変換することができない",
            "九九を覚えるのに、他の人より何倍も時間がかかった",
            "図形の問題（回転させた形など）が全く理解できない",
            "左右（右と左）を瞬時に判断できないことがある",
            "地図を読んで目的地にたどり着くのが難しい",
            "アナログ時計の針を見て、時刻を読み取るのが苦手",
            "「10分後」「1時間前」といった時間の計算ができない",
            "順序立てて物事を説明するのが苦手",
            "複数の指示を一度に受けると、1つ目しか覚えられない",
            "短期記憶が弱く、さっき聞いたことをすぐ忘れる",
            "物の名前がすぐに出てこず「あれ」「それ」を多用する",
            "物語の時系列（昔・今）を整理するのが苦手",
            "上下左右、前後などの位置関係を把握しにくい",
            "道具（ハサミ、定規、コンパス）を器用に使えない",
            "球技でボールをキャッチするのが苦手（空間把握の弱さ）",
            "ダンスや体操などの複雑な動きを真似できない",
            "文脈から不明な言葉の意味を推測するのが難しい",
            "表やグラフから情報を読み取ることが苦手",
            "主語と述語がバラバラな文章を書いてしまう",
            "ノートの使い方が不自然で、書き方が整理されていない",
            "筆圧が極端に強い、あるいは弱すぎて字が薄い",
            "記憶の抜け落ち（自分の行動の記憶など）が目立つ",
            "論理的な飛躍があり、話が支離滅裂になりやすい",
            "パズルや積み木の組み立てが苦手",
            "お釣りの計算ができず、小銭が財布に溜まってしまう",
            "物事の優先順位をつけるのが非常に苦手",
            "抽象的な概念（平和、自由など）の理解に時間がかかる",
            "比率（％）や分数の概念が直感的に分からない",
            "自分が書いた字を後で読み返すことができない",
            "カレンダーの管理ができず、約束を忘れる",
            "辞書を引く作業に時間がかかりすぎる",
            "文字を書くのが遅く、板書が間に合わない",
            "英単語のスペルが全く覚えられない",
            "物事を分類（仲間分け）するのが苦手",
            "原因と結果の関係を結びつけるのが苦手",
            "話の要点を一言でまとめることができない",
            "手順書やマニュアルを理解するのに苦労する",
            "図画工作で、完成図を想像しながら作ることができない",
            "自分の考えを紙に書き出すと、まとまらなくなる"
        ];

        // 質問の統合
        const allQuestions = [];
        emotionData.forEach(text => allQuestions.push({ category: "情緒型発達", type: "emotion", text }));
        intellectData.forEach(text => allQuestions.push({ category: "知育型発達", type: "intellect", text }));

        const totalCount = allQuestions.length;
        document.getElementById('total-count').innerText = totalCount;

        // 状態管理
        let currentIndex = 0;
        let userAnswers = []; // true(はい) または false(いいえ) を保存

        // 画面切り替え関数
        function showScreen(screenId) {
            document.querySelectorAll('.card').forEach(card => card.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        // チェック開始
        function startCheck() {
            currentIndex = 0;
            userAnswers = [];
            showScreen('question-screen');
            renderQuestion();
        }

        // 質問を画面に描画
        function renderQuestion() {
            const q = allQuestions[currentIndex];

            // プログレス＆テキスト更新
            document.getElementById('current-count').innerText = currentIndex + 1;
            document.getElementById('progress-fill').style.width = `${((currentIndex) / totalCount) * 100}%`;

            document.getElementById('category-badge').innerText = q.category;
            document.getElementById('question-text').innerText = q.text;

            // 最初だけ「戻る」ボタンを隠す
            document.getElementById('back-btn').style.display = currentIndex === 0 ? 'none' : 'inline-block';
        }

        // はい / いいえ の回答
        function answer(isYes) {
            userAnswers[currentIndex] = isYes;
            currentIndex++;

            if (currentIndex < totalCount) {
                renderQuestion();
            } else {
                // 完了したら100%にして結果画面へ
                document.getElementById('progress-fill').style.width = '100%';
                setTimeout(() => {
                    calculateResults();
                    showScreen('result-screen');
                }, 300);
            }
        }

        // １つ戻る
        function goBack() {
            if (currentIndex > 0) {
                currentIndex--;
                renderQuestion();
            }
        }

        // 結果計算＆表示
        function calculateResults() {
            let emotionTrueCount = 0;
            let intellectTrueCount = 0;

            userAnswers.forEach((ans, idx) => {
                if (ans) {
                    if (allQuestions[idx].type === 'emotion') emotionTrueCount++;
                    if (allQuestions[idx].type === 'intellect') intellectTrueCount++;
                }
            });

            // 50問中のパーセンテージ
            const emotionPercent = Math.round((emotionTrueCount / emotionData.length) * 100);
            const intellectPercent = Math.round((intellectTrueCount / intellectData.length) * 100);

            // 数字アニメーション表示
            animateValue(document.getElementById('res-emotion'), 0, emotionPercent, 1000);
            animateValue(document.getElementById('res-intellect'), 0, intellectPercent, 1000);

            // 80%以上なら赤文字にする
            setTimeout(() => {
                const elEmotion = document.getElementById('res-emotion');
                const elIntellect = document.getElementById('res-intellect');
                if (emotionPercent >= 80) elEmotion.classList.add('high');
                if (intellectPercent >= 80) elIntellect.classList.add('high');

                // 80%以上で案内を表示
                if (emotionPercent >= 80 || intellectPercent >= 80) {
                    document.getElementById('guidance-section').style.display = 'block';
                }
            }, 1000);
        }

        // 数字カウントアップのアニメーション
        function animateValue(obj, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const easeProgress = 1 - Math.pow(1 - progress, 4); // easeOutQuart 
                obj.innerHTML = Math.floor(easeProgress * (end - start) + start) + '<span>%</span>';
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                } else {
                    obj.innerHTML = end + '<span>%</span>';
                }
            };
            window.requestAnimationFrame(step);
        }

    </script>
</body>

</html>